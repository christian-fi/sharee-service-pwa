<!-- SPDX-License-Identifier: AGPL-3.0-or-later
 Copyright (c) Christian Fischer, TeilRad GmbH  -->
 <ion-header>
    <ion-navbar color="tink-blue"> 
        <ion-title> Rad <ion-badge [ngClass]="'Station-' + bike_group" >{{nid}}</ion-badge>
        </ion-title>
        <ion-title>
            <ion-badge [ngClass]="'rad-' + service_state" >&nbsp;&nbsp;</ion-badge> 
            
          <!--
          <ion-badge color="danger" *ngIf="service_type=='1'" class="station">&nbsp;df&nbsp;</ion-badge>
          <ion-badge color="primary" *ngIf="service_type=='2'" class="station">&nbsp;td&nbsp;</ion-badge>
          <ion-badge color="secondary" *ngIf="service_type=='3'" class="station">&nbsp;ck&nbsp;</ion-badge>
          <ion-badge color="light" *ngIf="service_type=='0'" class="station">&nbsp;ok&nbsp;</ion-badge> -->
           
          {{description}} 
        </ion-title>
            <ion-buttons end>
              <button ion-button icon-only *ngIf="service_state=='1' && bike_station ==restProvider.Station_Werkstatt">
                <ion-icon name="home" color="danger" ><span style="font-size:14px;font-family:arial;" > in <br>Werkstatt</span></ion-icon>
              </button>
              <button ion-button icon-only *ngIf="service_state=='1' && bike_station!=restProvider.Station_Werkstatt" on-click="saveRadWerkstatt()">
                <ion-icon name="home" color="white" ><span style="font-size:14px;font-family:arial" > zur <br>Werkstatt</span></ion-icon>
              </button>
              <button ion-button icon-only *ngIf="service_state!=='1' && (aufgabe_api!=='NaN' || aufgabe_api!=='::erledigt::'  ) " on-click="saveRadService('state','defect','def')">
                <ion-icon name="construct" color="danger" ></ion-icon>
              </button>
              <button ion-button icon-only *ngIf="service_state=='1'" on-click="saveRadService('state','available','available')">
                <ion-icon name="checkmark-circle" color="light" ><span style="font-size:14px;font-family:arial" > ok</span></ion-icon>
              </button>
            </ion-buttons>
<!--
<ion-badge color="danger" class="station" *ngIf="service_state!=='1'" on-click="saveRadService('state','defect')">&nbsp;&nbsp;</ion-badge> 
-->  <!-- <ion-badge color="primary" class="station">&nbsp;&nbsp;&nbsp;</ion-badge> --> 
       <!-- <button ion-button color="danger" small >def</button> -->
      
    </ion-navbar>
  </ion-header>

  <ion-content >

      <p style="padding-left:10px;padding-right:5px;padding-top:0px;">
          <strong><span *ngIf="service_state=='1' && bike_station ==restProvider.Station_Werkstatt">Werkstatt - </span>Station {{bike_station}} - zuletzt gesehen: {{zuletzt_gesehen_am}}</strong><br>
          <span style="white-space: pre;">{{zuletzt_gesehen}}</span>
          <br />   
        </p>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input style="margin-top:6px;margin-left:-10px;" type="tel" size="3" #inputToFocus placeholder="Nr" name="station-id"  [(ngModel)]="new_station_id" (keyup.enter)="saveRadStation();">
        <button class="button-small-md" type=submit ion-button  color="positive" on-click="saveRadStation();">
          GO-Station
        </button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        
        <ion-badge id="kku-lock" color="miss"   clear item-right class="akku_info">60%</ion-badge>
       <button class="button-small-md" ion-button  outline on-click="showConfirm_AkkuVoll('SmartLock');"><ion-icon name="battery-full"  class="akku_aktion_full"></ion-icon></button>
       &nbsp;&nbsp;&nbsp;
       <button id="kku-bike" type=submit class="button-small-md" ion-button color="danger" item-right >20%</button>
       <button class="button-small-md" ion-button  outline on-click="showConfirm_AkkuVoll('Fahrrad');"><ion-icon name="battery-full"  class="akku_aktion_full"></ion-icon></button>
          
        <ion-label stacked  >&nbsp;&nbsp;&nbsp;<ion-icon name="build" item-right *ngIf="todo_info=='1'">&nbsp;</ion-icon>Aufgabe &nbsp;&nbsp;&nbsp;&nbsp;
          <!--<button class="button-small-md" ion-button  outline on-click="showConfirm_AkkuVoll('Fahrrad');">  <ion-icon name="add-circle" color="aktion-blue" style="font-size: 25px;"></ion-icon></button>-->
        </ion-label>  
        <div id="aufgaben_div">
        <!-- <form>
            <ion-textarea placeholder="hier eingeben was zu tun ist " type="text" [(ngModel)]="aufgabe" name="aufgaben" rows=2></ion-textarea>          
          <button class="button-small-md" type=submit ion-button color="positive" icon-right on-click="saveRadService('txt01',aufgabe,'aufgabe');" >
            Speichern
          </button>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<ion-icon name="checkmark-circle" color="secondary"  item-right  on-click="saveRadService()" style="font-size: 35px;"></ion-icon>
        </form>
      <hr> -->
      <form>
        <ion-textarea placeholder="... hier eingeben was zu tun ist " type="text" [(ngModel)]="aufgabe" name="aufgaben" rows=2></ion-textarea>          
        <button class="button-small-md" type=submit ion-button color="positive" on-click="saveRadService('txt01',aufgabe,'aufgabe');" >Speichern</button>
        <button class="button-small-md" type=submit ion-button color="positive" on-click="saveRadService('txt01','::erledigt::',sid_erledigt);">&nbsp;Erledigt</button>  
        <button class="button-small-md" type=submit ion-button color="positive" item-right on-click="saveRadService('txt01','::erledigt::',sid_erledigt);">&nbsp;NEU</button>  
      </form>
    <hr>
    <!--
      <form>
        <ion-textarea placeholder="hier eingeben was zu tun ist " type="text" [(ngModel)]="aufgabe1" name="aufgaben" rows=2></ion-textarea>
        
        <ion-icon name="arrow-dropdown" color="aktion-blue"  item-right  on-click="saveRadAufgabe()"></ion-icon>
        <ion-icon name="checkmark-circle" color="secondary"  item-right on-click="saveRadAufgabe()"></ion-icon>
      
    </form> 
    <hr>
    <form>
        <ion-textarea placeholder="hier eingeben was zu tun ist " type="text" [(ngModel)]="aufgabe2" name="aufgaben" rows=2></ion-textarea>
        
        <ion-icon name="arrow-dropdown" color="tink-blue"  item-right  on-click="saveRadAufgabe()"></ion-icon>
        <ion-icon name="checkmark-circle" color="secondary"  item-right on-click="saveRadAufgabe()"></ion-icon>
        
    </form> 
    <hr>
  -->
</div>
  <ion-item *ngFor="let item of currentItems; let i = index" color="positive"  id="" >
        
        <ion-label><ion-badge color="secondary" *ngIf="item.service_type=='2'" class="station">&nbsp;</ion-badge>{{item.work_name}} {{item.mtime.substr(8,2)}}.{{item.mtime.substr(5,2)}}.{{item.mtime.substr(2,2)}}+{{item.interval}}T <!--(hw {{item.service_type}})--></ion-label>
        <ion-icon name="checkmark-circle" color="danger"  item-right *ngIf="item.time_over=='1'" on-click="saveRadService(item.work_id,1,i)"></ion-icon>
        <ion-icon name="checkmark-circle" color="secondary"  item-right *ngIf="item.time_over=='0'" on-click="saveRadService(item.work_id,1,i)"></ion-icon>
      </ion-item>
<br>
<hr>
&nbsp;&nbsp;&nbsp;&nbsp;Schloss Service-Code:&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<ion-icon *ngFor="let data of service_code" name="aperture" color="sc-{{data}}" style="font-size:25px">&nbsp;</ion-icon>

<!--<ion-icon name="aperture" color="sc-{{service_code}}"></ion-icon>
<ion-icon name="aperture" color="sc-green"></ion-icon>
<ion-icon name="aperture" color="sc-blue"></ion-icon>
-->
<hr>
&nbsp;&nbsp;&nbsp;&nbsp;Service-Logbuch:&nbsp;&nbsp;
<form>
  <ion-input placeholder="30" name="nummer" [(ngModel)]="suchenr"  (keyup.enter)="readServiceLog()"></ion-input>
</form>
<ion-item><button  ion-button color="positive" block icon-left style="border-radius:10px 10px 10px 10px;" on-click="readServiceLog()">Jetzt Logbuch Anzeigen
</button></ion-item>

<ion-item *ngFor="let item of currentItemsLog; let i = index" color="positive"  id="" >
  <style> #history_line { white-space:normal }</style> 
  <ion-label id="history_line"><ion-badge color="secondary" *ngIf="item.service_type=='2'" class="station">&nbsp;</ion-badge>{{item.mtime.substr(8,2)}}.{{item.mtime.substr(5,2)}}.{{item.mtime.substr(2,2)}} {{item.mtime.substr(11,5)}}  {{item.user_name}} <span *ngIf="item.user_name!=''"><br></span>{{item.work_name}}<span *ngIf="item.work_name=='Aufgaben' && item.work_val!='::erledigt::' ">: {{item.work_val}}</span><span *ngIf="item.work_name=='Aufgaben' && item.work_val=='::erledigt::' "> erledigt </span><span *ngIf="item.work_name!='Aufgaben'"> +{{item.interval}}T</span> <!--(hw {{item.service_type}})--></ion-label>
</ion-item>

<ion-item *ngIf="!currentItemsLog" color="positive"  id="" >
   <ion-label on-click="readServiceLog()">zur Anzeige bitte klicken, scrollen <ion-icon  name="checkmark-circle" color="secondary"  item-right  ></ion-icon></ion-label>
</ion-item>

          
  </ion-content>